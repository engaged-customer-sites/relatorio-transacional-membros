import{e as $,Q as F,l as L}from"./axios.b144294e.js";import{c as Q,r as x,E as A,a0 as N,ag as O,o as T,h as U,b as j,g as z,a1 as D,B as P,e as K,ax as M,f as G,ay as J,_ as C,as as H,az as W,K as S,at as V,N as m,M as X,Q as k,P as g,av as B,aw as Y,J as Z,aA as ee,aB as oe}from"./index.3f3ea55d.js";import"./use-dark.3fcce8a5.js";var te=Q({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(n,{slots:r,emit:l}){const a=z(),u=x(null);let s=0;const o=[];function _(e){const d=typeof e=="boolean"?e:n.noErrorFocus!==!0,y=++s,q=(t,i)=>{l("validation"+(t===!0?"Success":"Error"),i)},w=t=>{const i=t.validate();return typeof i.then=="function"?i.then(c=>({valid:c,comp:t}),c=>({valid:!1,comp:t,err:c})):Promise.resolve({valid:i,comp:t})};return(n.greedy===!0?Promise.all(o.map(w)).then(t=>t.filter(i=>i.valid!==!0)):o.reduce((t,i)=>t.then(()=>w(i).then(c=>{if(c.valid===!1)return Promise.reject(c)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return y===s&&q(!0),!0;if(y===s){const{comp:i,err:c}=t[0];if(c!==void 0&&console.error(c),q(!1,i),d===!0){const E=t.find(({comp:I})=>typeof I.focus=="function"&&D(I.$)===!1);E!==void 0&&E.comp.focus()}}return!1})}function b(){s++,o.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function f(e){e!==void 0&&P(e);const d=s+1;_().then(y=>{d===s&&y===!0&&(n.onSubmit!==void 0?l("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function p(e){e!==void 0&&P(e),l("reset"),K(()=>{b(),n.autofocus===!0&&n.noResetFocus!==!0&&v()})}function v(){$(()=>{if(u.value===null)return;const e=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),d=>d.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}A(M,{bindComponent(e){o.push(e)},unbindComponent(e){const d=o.indexOf(e);d>-1&&o.splice(d,1)}});let h=!1;return N(()=>{h=!0}),O(()=>{h===!0&&n.autofocus===!0&&v()}),T(()=>{n.autofocus===!0&&v()}),Object.assign(a.proxy,{validate:_,resetValidation:b,submit:f,reset:p,focus:v,getValidationComponents:()=>o}),()=>U("form",{class:"q-form",ref:u,onSubmit:f,onReset:p},j(r.default))}});function ne(){return G(J)}const ae="https://api.online.engaged.com.br/graphql";var se={LOGIN:ae};const re={setup(){const n=ne(),r=x(null),l=x(null),a=H(),u=W(),s=x(!0),o=async f=>{f.preventDefault(),s.value=!1;const p={query:`
        mutation {
          adminUserSignIn(email: "${r.value}", password: "${l.value}") {
            sessionToken
          }
        }
      `};try{const h=(await L.post("https://api.online.engaged.com.br/graphql",p)).data.data.adminUserSignIn.sessionToken;a.setToken(h),u.push({path:"/"})}catch{b("Login Failed","Invalid username or password"),s.value=!0}},_=()=>{r.value=null,l.value=null},b=(f,p)=>{n.notify({message:f,caption:p,icon:"error",color:"red"})};return{username:r,password:l,onSubmit:o,buttonVisible:s,onReset:_,routers:se}}},ie={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px","margin-top":"10%"}},ue=g("br",null,null,-1),le={key:0},ce={href:"https://campli.com.br/",target:"_blank"},de={key:1};function me(n,r,l,a,u,s){return S(),V("div",ie,[m(te,{onSubmit:a.onSubmit,onReset:a.onReset,class:"q-gutter-md"},{default:X(()=>[m(F,{filled:"",modelValue:a.username,"onUpdate:modelValue":r[0]||(r[0]=o=>a.username=o),label:"E-Mail",autocomplete:"username","lazy-rules":"",rules:[o=>o&&o.length>0||"Este campo \xE9 obrigat\xF3rio"]},null,8,["modelValue","rules"]),m(F,{filled:"",type:"password",modelValue:a.password,"onUpdate:modelValue":r[1]||(r[1]=o=>a.password=o),label:"Senha",autocomplete:"current-password",rules:[o=>o&&o.length>0||"Este campo \xE9 obrigat\xF3rio"]},null,8,["modelValue","rules"]),ue,a.buttonVisible?(S(),V("div",le,[m(k,{label:"Entrar",type:"submit",color:"primary"}),g("a",ce,[m(k,{label:"Registrar",color:"primary",flat:"",class:"q-ml-sm"})])])):B("",!0),a.buttonVisible?B("",!0):(S(),V("div",de,[m(Y,{color:"primary",size:"3em"})]))]),_:1},8,["onSubmit","onReset"])])}var fe=C(re,[["render",me]]);const pe={name:"LoginPage",components:{LoginForm:fe}},R=n=>(ee("data-v-17fb673a"),n=n(),oe(),n),ve={class:"login-page"},ge={class:"login-container"},_e=R(()=>g("br",null,null,-1)),be=R(()=>g("img",{src:"/relatorio-transacional-membros/icons/icon.png"},null,-1));function he(n,r,l,a,u,s){const o=Z("LoginForm");return S(),V("div",ve,[g("div",ge,[_e,be,m(o)])])}var qe=C(pe,[["render",he],["__scopeId","data-v-17fb673a"]]);export{qe as default};
