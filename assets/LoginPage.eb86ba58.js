import{e as k,Q as F,l as L}from"./axios.a6de86e5.js";import{c as Q,r as y,E as R,a0 as A,ag as N,o as O,h as T,b as U,g as j,a1 as z,B as P,e as D,ax as K,f as M,ay as G,_ as C,as as J,az as H,K as x,at as S,N as v,M as W,Q as X,av as B,aw as Y,P as V,J as Z,aA as ee,aB as oe}from"./index.ba7c2511.js";import"./use-dark.f10b580f.js";var te=Q({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(n,{slots:r,emit:l}){const a=j(),u=y(null);let s=0;const o=[];function g(e){const d=typeof e=="boolean"?e:n.noErrorFocus!==!0,h=++s,w=(t,i)=>{l("validation"+(t===!0?"Success":"Error"),i)},E=t=>{const i=t.validate();return typeof i.then=="function"?i.then(c=>({valid:c,comp:t}),c=>({valid:!1,comp:t,err:c})):Promise.resolve({valid:i,comp:t})};return(n.greedy===!0?Promise.all(o.map(E)).then(t=>t.filter(i=>i.valid!==!0)):o.reduce((t,i)=>t.then(()=>E(i).then(c=>{if(c.valid===!1)return Promise.reject(c)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return h===s&&w(!0),!0;if(h===s){const{comp:i,err:c}=t[0];if(c!==void 0&&console.error(c),w(!1,i),d===!0){const I=t.find(({comp:q})=>typeof q.focus=="function"&&z(q.$)===!1);I!==void 0&&I.comp.focus()}}return!1})}function _(){s++,o.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function m(e){e!==void 0&&P(e);const d=s+1;g().then(h=>{d===s&&h===!0&&(n.onSubmit!==void 0?l("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function f(e){e!==void 0&&P(e),l("reset"),D(()=>{_(),n.autofocus===!0&&n.noResetFocus!==!0&&p()})}function p(){k(()=>{if(u.value===null)return;const e=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),d=>d.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}R(K,{bindComponent(e){o.push(e)},unbindComponent(e){const d=o.indexOf(e);d>-1&&o.splice(d,1)}});let b=!1;return A(()=>{b=!0}),N(()=>{b===!0&&n.autofocus===!0&&p()}),O(()=>{n.autofocus===!0&&p()}),Object.assign(a.proxy,{validate:g,resetValidation:_,submit:m,reset:f,focus:p,getValidationComponents:()=>o}),()=>T("form",{class:"q-form",ref:u,onSubmit:m,onReset:f},U(r.default))}});function ne(){return M(G)}const ae="https://api.online.engaged.com.br/graphql";var se={LOGIN:ae};const re={setup(){const n=ne(),r=y(null),l=y(null),a=J(),u=H(),s=y(!0),o=async m=>{m.preventDefault(),s.value=!1;const f={query:`
        mutation {
          adminUserSignIn(email: "${r.value}", password: "${l.value}") {
            sessionToken
          }
        }
      `};try{const b=(await L.post("https://api.online.engaged.com.br/graphql",f)).data.data.adminUserSignIn.sessionToken;a.setToken(b),u.push({path:"/"})}catch{_("Login Failed","Invalid username or password"),s.value=!0}},g=()=>{r.value=null,l.value=null},_=(m,f)=>{n.notify({message:m,caption:f,icon:"error",color:"red"})};return{username:r,password:l,onSubmit:o,buttonVisible:s,onReset:g,routers:se}}},ie={class:"q-pa-md",style:{"min-width":"300px","max-width":"400px","margin-top":"10%"}},ue=V("br",null,null,-1),le={key:0},ce={key:1};function de(n,r,l,a,u,s){return x(),S("div",ie,[v(te,{onSubmit:a.onSubmit,onReset:a.onReset,class:"q-gutter-md"},{default:W(()=>[v(F,{filled:"",modelValue:a.username,"onUpdate:modelValue":r[0]||(r[0]=o=>a.username=o),label:"E-Mail",autocomplete:"username","lazy-rules":"",rules:[o=>o&&o.length>0||"Este campo \xE9 obrigat\xF3rio"]},null,8,["modelValue","rules"]),v(F,{filled:"",type:"password",modelValue:a.password,"onUpdate:modelValue":r[1]||(r[1]=o=>a.password=o),label:"Senha",autocomplete:"current-password",rules:[o=>o&&o.length>0||"Este campo \xE9 obrigat\xF3rio"]},null,8,["modelValue","rules"]),ue,a.buttonVisible?(x(),S("div",le,[v(X,{label:"Entrar",type:"submit",color:"primary"})])):B("",!0),a.buttonVisible?B("",!0):(x(),S("div",ce,[v(Y,{color:"primary",size:"3em"})]))]),_:1},8,["onSubmit","onReset"])])}var me=C(re,[["render",de]]);const fe={name:"LoginPage",components:{LoginForm:me}},$=n=>(ee("data-v-17fb673a"),n=n(),oe(),n),pe={class:"login-page"},ve={class:"login-container"},ge=$(()=>V("br",null,null,-1)),_e=$(()=>V("img",{src:"/relatorio-transacional-membros/icons/icon.png"},null,-1));function be(n,r,l,a,u,s){const o=Z("LoginForm");return x(),S("div",pe,[V("div",ve,[ge,_e,v(o)])])}var Ve=C(fe,[["render",be],["__scopeId","data-v-17fb673a"]]);export{Ve as default};
